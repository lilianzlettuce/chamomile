<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Chamomile</title>
        <link rel="icon" type="image/x-icon" href="favicon.ico"/>
        <!--fonts-->
        <link href="https://fonts.googleapis.com/css2?family=Barlow:wght@300&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Bad+Script&family=Caveat&family=Cutive+Mono&family=Dancing+Script&family=Flamenco&family=Montserrat&family=Josefin+Slab&family=Quicksand&display=swap" rel="stylesheet">
        <!--FontAwesome Icons-->
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
        <!--my css-->
        <link rel="stylesheet" href="style.css">
    </head>
    <body>
        <div id="login-page">
            <div class="deco" id="login-deco"></div>
            <div class="deco" id="login-deco2"></div>
            <div class="deco" id="login-deco3"></div>
            <div id="login-box">
                <h5 id="login-title">Sign in to Chamomile</h5>
                <input type="email" placeholder="Email" class="login-input" id="email" />
                <input type="password" placeholder="Password" class="login-input" id="password">
                <button id="loginBtn" class="button">Login</button>
                <p id="create-acct">Create an account</p>
            </div>
        </div>

        <!--goal setting & profile page-->
        <div id="logout-page">
            <button id="logoutBtn" class="button">Logout</button>
            <div id="logout-flex-1" class="section">
                <div class="logout-text">Daily Goal</div>
                <div class="goalset">
                    <div class="logout-text-small">Sleep: &nbsp &nbsp
                        <input type="number" placeholder="7" class="logout-input" id="sleepGoal"/> hrs
                    </div>
                    <div class="logout-text-small">
                        <input type="number" placeholder="7" class="logout-input" id="sleep-num-times"/> days 
                        in the next  &nbsp &nbsp
                        <input type="number" placeholder="2" class="logout-input" id="sleep-num-weeks"/> weeks
                    </div>
                </div>
                <div class="goalset">
                    <div class="logout-text-small">Exercise: &nbsp &nbsp
                        <input type="number" placeholder="15" class="logout-input" id="eGoal"/> mins
                    </div>
                    <div class="logout-text-small">
                        <input type="number" placeholder="7" class="logout-input" id="e-num-times"/> days 
                        in the next  &nbsp &nbsp
                        <input type="number" placeholder="2" class="logout-input" id="e-num-weeks"/> weeks
                    </div>
                </div>
                <div id="btn-flexbox">
                    <button class="usableBtn" id="goalBtn">Start</button>
                    <button class="unusableBtn" id="restartBtn">Restart</button>
                </div>
            </div>
            
            <div class="section logout-flex-2">
                <div class="logout-text">Exercise</div>
                <canvas id="eGoalChart" width="270" height="270"></canvas>
                <div class="logout-text percent-complete"><span id="e-goal-percent">0.0</span>%</div>
            </div>

            <button id="slideUpBtn" class="fas fa-chevron-up"></button>
            <button id="slideDownBtn" class="fas fa-chevron-down"></button>
            <div id="filler"></div>
        </div>

        <!--middle section-->
        <div id="section-mid">

            <!--the part that slides aka section 4: e goal display next to e log chart-->
            <div id="slider" class="set section">
                <h1 id="title0">breathe</h1> 
                
            </div>

            <!--sleep goal display next to sleep log chart-->
            <div id="section1" class="set section">
                <h3>Goal</h3>

                <div>
                    <div>&nbsp</div>
                    <canvas id="sleepGoalChart" width="350" height="350" style="top: 0;"></canvas>
                    <div id="SPG" class="logout-text percent-complete"><span>0.0</span>%</div>
                </div>

                <div id="goal-main-display">
                    <div style="font-size: 2rem;"><span id="hoursPD" class="big-number">0</span> hrs per day</div>
                    <div style="font-size: 2rem;"><span id="sleep-num-days" class="big-number">0</span> days remaining</div>
                </div>


                <!--
                <div id="profile-flex-1">
                    <i class="fas fa-user-secret"></i>
                    <h3 id="title1">Joebob Joestar</h3>
                </div>
                <div id="profile-flex-2">
                    <div class="stats-flex">
                        <h4 class="label">Age</h4>
                        <h2 class="stats">6</h2>
                    </div>
                    <div class="stats-flex">
                        <h4 class="label">Weight</h4>
                        <h2 class="stats">825 <span style="font-size: 4rem;">lb</span></h2>
                    </div>
                    <div class="stats-flex">
                        <h4 class="label">Height</h4>
                        <h2 class="stats">52<span style="font-size: 5rem;">'</span>8<span style="font-size: 5rem;">''</span></h2>
                    </div>
                </div>

                <div class="deco" id="deco2"></div>
                <div class="deco" id="deco3"></div>
                <div class="deco" id="deco1"></div>
                -->
            </div>
            <button id="slideBtn" class="button">&nbsp ⟷ &nbsp</button>
            
            <div id="goalPopUp">
                <div>Congrats! You completed a goal.</div>
                <button>Complete Goal</button>
            </div>

            <!--sleep log chart-->
            <div id="section2" class="set2 section">
                <button class="button" id="seeMonthlyBtn">See Monthly Data →</button>
                <h3 id="title2">Sleep</h3>
                <div id="avg-box">
                    <div class="averages">Weekly average: <span id="weeklyAvg">0.0</span> hrs/day</div>
                    <div class="averages"><span id="sign">+</span> <span id="percentage">0.00</span>% from last week</div>
                </div>
                <canvas id="sleepChart" width="280" height="190"></canvas>
                <div id="data-flex-0">
                    <div id="data-flex-1">
                        <input id="data" type="number" placeholder="7">
                        <button class="button2" id="addDataBtn">Add</button>
                        <button class="button2" id="removeDataBtn">Delete</button>
                        <button class="button2" id="saveBtn">Save Data</button>
                    </div>
                </div>
            </div>

            <!--e log chart-->
            <div id="section3" class="set section">
                <audio src="Rickroll But It's Lofi.mp3" controls loop>j</audio>
                
                <h1 id="title3">relax;</h1>
                <div id="timer-box">
                    <button id="beginBtn" class="button" onclick="startTimer()">Begin</button>
                </div>
                <div id="timer"></div>
            </div>

            <!--meditation animation-->
            <div id="circles">
                <div id="circle1" class="circle"></div>
                <div id="circle2" class="circle"></div>
                <div id="circle3" class="circle"></div>
                <div id="circle4" class="circle"></div>
                <div id="circle5" class="circle"></div>
                <div id="circle6" class="circle"></div>
                <div id="circle7" class="circle"></div>
            </div>
        </div>

        <!--my js-->
        <script src="App.js" charset="utf-8"></script>

        <!--chart.js-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"></script>

        <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
        <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-app.js"></script>

        <!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
        <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-analytics.js"></script>

        <!-- Add Firebase products that you want to use -->
        <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-firestore.js"></script>

        <script>
            // Your web app's Firebase configuration
            // For Firebase JS SDK v7.20.0 and later, measurementId is optional
            var firebaseConfig = {
                apiKey: "AIzaSyAG650qxqWeEw_ceWdT8x9pmvH9YFCY71Q",
                authDomain: "slide-f4c66.firebaseapp.com",
                projectId: "slide-f4c66",
                storageBucket: "slide-f4c66.appspot.com",
                messagingSenderId: "894672700642",
                appId: "1:894672700642:web:d9a21c171a419d830d4abb",
                measurementId: "G-HBJYT7J3DJ"
            };
            // Initialize Firebase
            firebase.initializeApp(firebaseConfig);
            firebase.analytics();
        </script>

        <script>
            const FULL_DASH_ARRAY = 283;
            const WARNING_THRESHOLD = 10;
            const ALERT_THRESHOLD = 5;

            const COLOR_CODES = {
            info: {
                color: "green"
            },
            warning: {
                color: "orange",
                threshold: WARNING_THRESHOLD
            },
            alert: {
                color: "red",
                threshold: ALERT_THRESHOLD
            }
            };

            const TIME_LIMIT = 300; // 5 min
            let timePassed = 0;
            let timeLeft = TIME_LIMIT;
            let timerInterval = null;
            let remainingPathColor = COLOR_CODES.info.color;

            document.getElementById("timer").innerHTML = `
            <div class="base-timer">
            <svg class="base-timer__svg" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <g class="base-timer__circle">
                <circle class="base-timer__path-elapsed" cx="50" cy="50" r="45"></circle>
                <path
                    id="base-timer-path-remaining"
                    stroke-dasharray="283"
                    class="base-timer__path-remaining ${remainingPathColor}"
                    d="
                    M 50, 50
                    m -45, 0
                    a 45,45 0 1,0 90,0
                    a 45,45 0 1,0 -90,0
                    "
                ></path>
                </g>
            </svg>
            <span id="base-timer-label" class="base-timer__label">${formatTime(
                timeLeft
            )}</span>
            </div>
            `;

            // startTimer();

            function onTimesUp() {
                clearInterval(timerInterval);
            }

            function startTimer() {
                timePassed = 0;
                timerInterval = setInterval(() => {
                    timePassed = timePassed += 1;
                    timeLeft = TIME_LIMIT - timePassed;
                    document.getElementById("base-timer-label").innerHTML = formatTime(
                    timeLeft
                    );
                    setCircleDasharray();
                    setRemainingPathColor(timeLeft);

                    if (timeLeft === 0) {
                    onTimesUp();
                    }
                }, 1000);
            }

            function formatTime(time) {
                const minutes = Math.floor(time / 60);
                let seconds = time % 60;

                if (seconds < 10) {
                    seconds = `0${seconds}`;
                }

                return `${minutes}:${seconds}`;
            }

            function setRemainingPathColor(timeLeft) {
                const { alert, warning, info } = COLOR_CODES;
                if (timeLeft <= alert.threshold) {
                    document
                    .getElementById("base-timer-path-remaining")
                    .classList.remove(warning.color);
                    document
                    .getElementById("base-timer-path-remaining")
                    .classList.add(alert.color);
                } else if (timeLeft <= warning.threshold) {
                    document
                    .getElementById("base-timer-path-remaining")
                    .classList.remove(info.color);
                    document
                    .getElementById("base-timer-path-remaining")
                    .classList.add(warning.color);
                }
            }

            function calculateTimeFraction() {
                const rawTimeFraction = timeLeft / TIME_LIMIT;
                return rawTimeFraction - (1 / TIME_LIMIT) * (1 - rawTimeFraction);
            }

            function setCircleDasharray() {
                const circleDasharray = `${(
                    calculateTimeFraction() * FULL_DASH_ARRAY
                    ).toFixed(0)} 283`;
                document
                    .getElementById("base-timer-path-remaining")
                    .setAttribute("stroke-dasharray", circleDasharray);
            }
        </script>
    </body>
</html>