<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Slide</title>
        <link rel="icon" type="image/x-icon" href="favicon.ico"/>
        <!--fonts-->
        <link href="https://fonts.googleapis.com/css2?family=Barlow:wght@300&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Bad+Script&family=Caveat&family=Cutive+Mono&family=Dancing+Script&family=Flamenco&family=Montserrat&family=Josefin+Slab&family=Quicksand&display=swap" rel="stylesheet">
        <!--FontAwesome Icons-->
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
        <!--my css-->
        <link rel="stylesheet" href="style.css">
    </head>
    <body>

        <div class="deco" id="deco2"></div>
        <div class="deco" id="deco3"></div>
        <div class="deco" id="deco1"></div>

        <div id="slider" class="set section">
            <h1 id="title0">breathe</h1>
        </div>
        <div id="section1" class="set section">
            <div id="profile-flex-1">
                <i class="fas fa-user-secret"></i>
                <h3 id="title1">Joebob Smith</h3>
            </div>
            <div id="profile-flex-2">
                <div class="stats-flex">
                    <h4 class="label">Age</h4>
                    <h2 class="stats">6</h2>
                </div>
                <div class="stats-flex">
                    <h4 class="label">Weight</h4>
                    <h2 class="stats">825 <span style="font-size: 4rem;">lb</span></h2>
                </div>
                <div class="stats-flex">
                    <h4 class="label">Height</h4>
                    <h2 class="stats">52<span style="font-size: 5rem;">'</span>8<span style="font-size: 5rem;">''</span></h2>
                </div>
            </div>
        </div>
        <div id="slideBtn" class="button">&nbsp ⟷ &nbsp</div>
        <div id="section2" class="set2 section">
            <div class="button" id="monthlyBtn">See Monthly Data →</div>
            <h3 id="title2">Sleep</h3>
            <canvas id="myChart" width="400" height="300"></canvas>
            <div id="data-flex-0">
                <div id="data-flex-1">
                    <div id="data-flex-2">
                        <div class="button2" id="addDataBtn">Add</div>
                        <div class="button2" id="removeDataBtn">Delete</div>
                    </div>
                    <div class="button2" id="saveBtn">Save Data</div>
                </div>
                <div id="data-flex-3">
                    <div>
                        <input id="data" type="number" placeholder="# hours">
                        <input id="label" type="text" placeholder="Day">
                    </div>
                    <div class="averages">Weekly average: <span id="weeklyAvg">6.2</span> hrs/day</div>
                    <div class="averages"><span id="sign">+</span> <span id="percentage">6.90</span>% from last week</div>
                </div>
            </div>
        </div>
        <div id="section3" class="set section">
            <!-- ADD STUFF BETWEEN HERE-->
            <audio src="/music/Rickroll But It's Lofi.mp3" controls autoplay loop>
                <p>If you are reading this, it is because your browser does not support the audio element.</p>
              </audio>
            <h1 id="title3">relax;</h1>
            <div id="timer-box">
                <div id="beginBtn" class="button" onclick="startTimer()">Begin</div>
            </div>
            <div id="timer"></div>
            <!-- ADD STUFF BETWEEN HERE-->
        </div>

        <div id="circles">
            <div id="circle1" class="circle"></div>
            <div id="circle2" class="circle"></div>
            <div id="circle3" class="circle"></div>
            <div id="circle4" class="circle"></div>
            <div id="circle5" class="circle"></div>
            <div id="circle6" class="circle"></div>
            <div id="circle7" class="circle"></div>
        </div>
        <!--my js-->
        <script src="App.js" charset="utf-8"></script>

        <!--chart.js-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"></script>

        <!-- The core Firebase JS SDK is always required and must be listed first -->
        <script src="/__/firebase/8.3.1/firebase-app.js"></script>

        <!-- TODO: Add SDKs for Firebase products that you want to use
            https://firebase.google.com/docs/web/setup#available-libraries -->
        <script src="/__/firebase/8.3.1/firebase-analytics.js"></script>

        <!-- Initialize Firebase -->
        <script src="/__/firebase/init.js"></script>
        <script>
const FULL_DASH_ARRAY = 283;
const WARNING_THRESHOLD = 10;
const ALERT_THRESHOLD = 5;

const COLOR_CODES = {
  info: {
    color: "green"
  },
  warning: {
    color: "orange",
    threshold: WARNING_THRESHOLD
  },
  alert: {
    color: "red",
    threshold: ALERT_THRESHOLD
  }
};

const TIME_LIMIT = 300; // 5 min
let timePassed = 0;
let timeLeft = TIME_LIMIT;
let timerInterval = null;
let remainingPathColor = COLOR_CODES.info.color;

document.getElementById("timer").innerHTML = `
<div class="base-timer">
  <svg class="base-timer__svg" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
    <g class="base-timer__circle">
      <circle class="base-timer__path-elapsed" cx="50" cy="50" r="45"></circle>
      <path
        id="base-timer-path-remaining"
        stroke-dasharray="283"
        class="base-timer__path-remaining ${remainingPathColor}"
        d="
          M 50, 50
          m -45, 0
          a 45,45 0 1,0 90,0
          a 45,45 0 1,0 -90,0
        "
      ></path>
    </g>
  </svg>
  <span id="base-timer-label" class="base-timer__label">${formatTime(
    timeLeft
  )}</span>
</div>
`;

// startTimer();

function onTimesUp() {
  clearInterval(timerInterval);
}

function startTimer() {
  timePassed = 0;
  timerInterval = setInterval(() => {
    timePassed = timePassed += 1;
    timeLeft = TIME_LIMIT - timePassed;
    document.getElementById("base-timer-label").innerHTML = formatTime(
      timeLeft
    );
    setCircleDasharray();
    setRemainingPathColor(timeLeft);

    if (timeLeft === 0) {
      onTimesUp();
    }
  }, 1000);
}

function formatTime(time) {
  const minutes = Math.floor(time / 60);
  let seconds = time % 60;

  if (seconds < 10) {
    seconds = `0${seconds}`;
  }

  return `${minutes}:${seconds}`;
}

function setRemainingPathColor(timeLeft) {
  const { alert, warning, info } = COLOR_CODES;
  if (timeLeft <= alert.threshold) {
    document
      .getElementById("base-timer-path-remaining")
      .classList.remove(warning.color);
    document
      .getElementById("base-timer-path-remaining")
      .classList.add(alert.color);
  } else if (timeLeft <= warning.threshold) {
    document
      .getElementById("base-timer-path-remaining")
      .classList.remove(info.color);
    document
      .getElementById("base-timer-path-remaining")
      .classList.add(warning.color);
  }
}

function calculateTimeFraction() {
  const rawTimeFraction = timeLeft / TIME_LIMIT;
  return rawTimeFraction - (1 / TIME_LIMIT) * (1 - rawTimeFraction);
}

function setCircleDasharray() {
  const circleDasharray = `${(
    calculateTimeFraction() * FULL_DASH_ARRAY
  ).toFixed(0)} 283`;
  document
    .getElementById("base-timer-path-remaining")
    .setAttribute("stroke-dasharray", circleDasharray);
}
        </script>
    </body>
</html>